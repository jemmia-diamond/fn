export const mapSalesOrderToDatabase = (salesOrder) => {
  return {
    name: salesOrder?.name || null,
    owner: salesOrder?.owner || null,
    creation: salesOrder?.creation ? new Date(salesOrder.creation) : null,
    modified: salesOrder?.modified ? new Date(salesOrder.modified) : null,
    modified_by: salesOrder?.modified_by || null,
    docstatus: salesOrder?.docstatus || null,
    idx: salesOrder?.idx || null,
    
    // Order information
    title: salesOrder?.title || null,
    naming_series: salesOrder?.naming_series || null,
    tax_id: salesOrder?.tax_id || null,
    order_type: salesOrder?.order_type || null,
    skip_delivery_note: salesOrder?.skip_delivery_note || null,
    delivery_date: salesOrder?.delivery_date ? new Date(salesOrder.delivery_date) : null,
    po_no: salesOrder?.po_no || null,
    po_date: salesOrder?.po_date ? new Date(salesOrder.po_date) : null,
    company: salesOrder?.company || null,
    amended_from: salesOrder?.amended_from || null,
    
    // Customer information
    customer_name: salesOrder?.customer_name || null,
    order_number: salesOrder?.order_number || null,
    transaction_date: salesOrder?.transaction_date ? new Date(salesOrder.transaction_date) : null,
    real_order_date: salesOrder?.real_order_date ? new Date(salesOrder.real_order_date) : null,
    cancelled_status: salesOrder?.cancelled_status || null,
    financial_status: salesOrder?.financial_status || null,
    fulfillment_status: salesOrder?.fulfillment_status || null,
    expected_delivery_date: salesOrder?.expected_delivery_date ? new Date(salesOrder.expected_delivery_date) : null,
    cost_center: salesOrder?.cost_center || null,
    project: salesOrder?.project || null,
    
    // Currency and pricing
    currency: salesOrder?.currency || null,
    conversion_rate: salesOrder?.conversion_rate || null,
    selling_price_list: salesOrder?.selling_price_list || null,
    price_list_currency: salesOrder?.price_list_currency || null,
    plc_conversion_rate: salesOrder?.plc_conversion_rate || null,
    ignore_pricing_rule: salesOrder?.ignore_pricing_rule || null,
    scan_barcode: salesOrder?.scan_barcode || null,
    set_warehouse: salesOrder?.set_warehouse || null,
    reserve_stock: salesOrder?.reserve_stock || null,
    
    // Discount and totals
    apply_discount_on: salesOrder?.apply_discount_on || null,
    base_discount_amount: salesOrder?.base_discount_amount || null,
    coupon_code: salesOrder?.coupon_code || null,
    additional_discount_percentage: salesOrder?.additional_discount_percentage || null,
    total_qty: salesOrder?.total_qty || null,
    total: salesOrder?.total || null,
    discount_amount: salesOrder?.discount_amount || null,
    grand_total: salesOrder?.grand_total || null,
    base_total: salesOrder?.base_total || null,
    base_net_total: salesOrder?.base_net_total || null,
    total_net_weight: salesOrder?.total_net_weight || null,
    net_total: salesOrder?.net_total || null,
    
    // Tax information
    tax_category: salesOrder?.tax_category || null,
    taxes_and_charges: salesOrder?.taxes_and_charges || null,
    shipping_rule: salesOrder?.shipping_rule || null,
    incoterm: salesOrder?.incoterm || null,
    named_place: salesOrder?.named_place || null,
    base_total_taxes_and_charges: salesOrder?.base_total_taxes_and_charges || null,
    total_taxes_and_charges: salesOrder?.total_taxes_and_charges || null,
    base_grand_total: salesOrder?.base_grand_total || null,
    base_rounding_adjustment: salesOrder?.base_rounding_adjustment || null,
    base_rounded_total: salesOrder?.base_rounded_total || null,
    base_in_words: salesOrder?.base_in_words || null,
    rounding_adjustment: salesOrder?.rounding_adjustment || null,
    rounded_total: salesOrder?.rounded_total || null,
    in_words: salesOrder?.in_words || null,
    advance_paid: salesOrder?.advance_paid || null,
    disable_rounded_total: salesOrder?.disable_rounded_total || null,
    other_charges_calculation: salesOrder?.other_charges_calculation || null,
    
    // Contact and address information
    contact_person: salesOrder?.contact_person || null,
    contact_display: salesOrder?.contact_display || null,
    contact_phone: salesOrder?.contact_phone || null,
    contact_mobile: salesOrder?.contact_mobile || null,
    contact_email: salesOrder?.contact_email || null,
    customer_address: salesOrder?.customer_address || null,
    address_display: salesOrder?.address_display || null,
    customer_group: salesOrder?.customer_group || null,
    territory: salesOrder?.territory || null,
    shipping_address_name: salesOrder?.shipping_address_name || null,
    shipping_address: salesOrder?.shipping_address || null,
    customer: salesOrder?.customer || null,
    gender: salesOrder?.gender || null,
    customer_type: salesOrder?.customer_type || null,
    customer_personal_id: salesOrder?.customer_personal_id || null,
    birth_date: salesOrder?.birth_date ? new Date(salesOrder.birth_date) : null,
    date_of_issuance: salesOrder?.date_of_issuance ? new Date(salesOrder.date_of_issuance) : null,
    dispatch_address: salesOrder?.dispatch_address || null,
    place_of_issuance: salesOrder?.place_of_issuance || null,
    dispatch_address_name: salesOrder?.dispatch_address_name || null,
    company_address: salesOrder?.company_address || null,
    company_address_display: salesOrder?.company_address_display || null,
    company_contact_person: salesOrder?.company_contact_person || null,
    
    // Status information
    status: salesOrder?.status || null,
    delivery_status: salesOrder?.delivery_status || null,
    per_delivered: salesOrder?.per_delivered || null,
    per_billed: salesOrder?.per_billed || null,
    per_picked: salesOrder?.per_picked || null,
    billing_status: salesOrder?.billing_status || null,
    
    // Sales and commission
    sales_partner: salesOrder?.sales_partner || null,
    amount_eligible_for_commission: salesOrder?.amount_eligible_for_commission || null,
    commission_rate: salesOrder?.commission_rate || null,
    total_commission: salesOrder?.total_commission || null,
    loyalty_points: salesOrder?.loyalty_points || null,
    loyalty_amount: salesOrder?.loyalty_amount || null,
    from_date: salesOrder?.from_date ? new Date(salesOrder.from_date) : null,
    to_date: salesOrder?.to_date ? new Date(salesOrder.to_date) : null,
    auto_repeat: salesOrder?.auto_repeat || null,
    
    // Print and display
    letter_head: salesOrder?.letter_head || null,
    group_same_items: salesOrder?.group_same_items || null,
    select_print_heading: salesOrder?.select_print_heading || null,
    language: salesOrder?.language || null,
    is_internal_customer: salesOrder?.is_internal_customer || null,
    represents_company: salesOrder?.represents_company || null,
    source: salesOrder?.source || null,
    inter_company_order_reference: salesOrder?.inter_company_order_reference || null,
    campaign: salesOrder?.campaign || null,
    party_account_currency: salesOrder?.party_account_currency || null,
    
    // Payment information
    total_amount: salesOrder?.total_amount || null,
    expected_payment_date: salesOrder?.expected_payment_date ? new Date(salesOrder.expected_payment_date) : null,
    paid_amount: salesOrder?.paid_amount || null,
    balance: salesOrder?.balance || null,
    payment_terms_template: salesOrder?.payment_terms_template || null,
    tc_name: salesOrder?.tc_name || null,
    terms: salesOrder?.terms || null,
    
    // Haravan integration
    haravan_order_id: salesOrder?.haravan_order_id || null,
    haravan_ref_order_id: salesOrder?.haravan_ref_order_id || null,
    haravan_created_at: salesOrder?.haravan_created_at ? new Date(salesOrder.haravan_created_at) : null,
    source_name: salesOrder?.source_name || null,
    
    // JSONB fields
    sales_team: salesOrder?.sales_team || null,
    ref_sales_orders: salesOrder?.ref_sales_orders || null,
    promotions: salesOrder?.promotions || null,
    product_categories: salesOrder?.product_categories || null,
    packed_items: salesOrder?.packed_items || null,
    taxes: salesOrder?.taxes || null,
    pricing_rules: salesOrder?.pricing_rules || null,
    payment_records: salesOrder?.payment_records || null,
    payment_schedule: salesOrder?.payment_schedule || null,
    policies: salesOrder?.policies || null,
    items: salesOrder?.items || null
  };
};

export const mapSalesOrderItemsToDatabase = (salesOrderItems) => {
  if (!salesOrderItems || !Array.isArray(salesOrderItems)) return [];
  return salesOrderItems.map(item => ({
    name: item?.name || null,
    owner: item?.owner || null,
    creation: item?.creation ? new Date(item.creation) : null,
    modified: item?.modified ? new Date(item.modified) : null,
    modified_by: item?.modified_by || null,
    docstatus: item?.docstatus || null,
    idx: item?.idx || null,
    item_name: item?.item_name || null,
    variant_title: item?.variant_title || null,
    sku: item?.sku || null,
    barcode: item?.barcode || null,
    haravan_variant_id: item?.haravan_variant_id || null,
    ensure_delivery_based_on_produced_serial_no: item?.ensure_delivery_based_on_produced_serial_no || null,
    is_stock_item: item?.is_stock_item || null,
    reserve_stock: item?.reserve_stock || null,
    qty: item?.qty || null,
    stock_uom: item?.stock_uom || null,
    uom: item?.uom || null,
    conversion_factor: item?.conversion_factor || null,
    stock_qty: item?.stock_qty || null,
    stock_reserved_qty: item?.stock_reserved_qty || null,
    price_list_rate: item?.price_list_rate || null,
    base_price_list_rate: item?.base_price_list_rate || null,
    discount_percentage: item?.discount_percentage || null,
    discount_amount: item?.discount_amount || null,
    distributed_discount_amount: item?.distributed_discount_amount || null,
    base_rate_with_margin: item?.base_rate_with_margin || null,
    margin_type: item?.margin_type || null,
    margin_rate_or_amount: item?.margin_rate_or_amount || null,
    rate_with_margin: item?.rate_with_margin || null,
    rate: item?.rate || null,
    amount: item?.amount || null,
    base_rate: item?.base_rate || null,
    base_amount: item?.base_amount || null,
    stock_uom_rate: item?.stock_uom_rate || null,
    is_free_item: item?.is_free_item || null,
    grant_commission: item?.grant_commission || null,
    net_rate: item?.net_rate || null,
    net_amount: item?.net_amount || null,
    base_net_rate: item?.base_net_rate || null,
    base_net_amount: item?.base_net_amount || null,
    billed_amt: item?.billed_amt || null,
    valuation_rate: item?.valuation_rate || null,
    gross_profit: item?.gross_profit || null,
    delivered_by_supplier: item?.delivered_by_supplier || null,
    weight_per_unit: item?.weight_per_unit || null,
    total_weight: item?.total_weight || null,
    against_blanket_order: item?.against_blanket_order || null,
    blanket_order_rate: item?.blanket_order_rate || null,
    actual_qty: item?.actual_qty || null,
    company_total_stock: item?.company_total_stock || null,
    projected_qty: item?.projected_qty || null,
    ordered_qty: item?.ordered_qty || null,
    planned_qty: item?.planned_qty || null,
    production_plan_qty: item?.production_plan_qty || null,
    work_order_qty: item?.work_order_qty || null,
    delivered_qty: item?.delivered_qty || null,
    produced_qty: item?.produced_qty || null,
    returned_qty: item?.returned_qty || null,
    picked_qty: item?.picked_qty || null,
    page_break: item?.page_break || null,
    item_tax_rate: item?.item_tax_rate || null,
    transaction_date: item?.transaction_date ? new Date(item.transaction_date) : null,
    cost_center: item?.cost_center || null,
    parent: item?.parent || null,
    parentfield: item?.parentfield || null,
    parenttype: item?.parenttype || null,
    doctype: item?.doctype || null
  }));
};
