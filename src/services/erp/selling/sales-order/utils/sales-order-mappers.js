import { safeValue } from "src/services/utils/data-mappers";

export const mapSalesOrdersToDatabase = (salesOrders) => {
  return salesOrders.map((salesOrder) => ({
    name: salesOrder?.name || null,
    owner: salesOrder?.owner || null,
    creation: safeValue(salesOrder?.creation,"date"),
    modified: safeValue(salesOrder?.modified,"date"),
    modified_by: safeValue(salesOrder?.modified_by,"string"),
    docstatus: safeValue(salesOrder?.docstatus,"number"),
    idx: safeValue(salesOrder?.idx,"number"),

    // Order information
    title: safeValue(salesOrder?.title,"string"),
    naming_series: safeValue(salesOrder?.naming_series,"string"),
    tax_id: safeValue(salesOrder?.tax_id,"string"),
    order_type: safeValue(salesOrder?.order_type,"string"),
    skip_delivery_note: safeValue(salesOrder?.skip_delivery_note,"string"),
    delivery_date: safeValue(salesOrder?.delivery_date,"date"),
    po_no: safeValue(salesOrder?.po_no,"string"),
    po_date: safeValue(salesOrder?.po_date,"date"),
    company: safeValue(salesOrder?.company,"string"),
    amended_from: safeValue(salesOrder?.amended_from,"string"),

    // Customer information
    customer_name: safeValue(salesOrder?.customer_name,"string"),
    order_number: safeValue(salesOrder?.order_number,"string"),
    transaction_date: safeValue(salesOrder?.transaction_date,"date"),
    real_order_date: safeValue(salesOrder?.real_order_date,"date"),
    cancelled_status: safeValue(salesOrder?.cancelled_status,"string"),
    financial_status: safeValue(salesOrder?.financial_status,"string"),
    fulfillment_status: safeValue(salesOrder?.fulfillment_status,"string"),
    expected_delivery_date: safeValue(salesOrder?.expected_delivery_date,"date"),
    cost_center: safeValue(salesOrder?.cost_center,"string"),
    project: safeValue(salesOrder?.project,"string"),
    consultation_date: safeValue(salesOrder?.consultation_date,"date"),

    // Currency and pricing
    currency: safeValue(salesOrder?.currency,"string"),
    conversion_rate: safeValue(salesOrder?.conversion_rate,"number"),
    selling_price_list: safeValue(salesOrder?.selling_price_list,"string"),
    price_list_currency: safeValue(salesOrder?.price_list_currency,"string"),
    plc_conversion_rate: safeValue(salesOrder?.plc_conversion_rate,"number"),
    ignore_pricing_rule: safeValue(salesOrder?.ignore_pricing_rule,"string"),
    scan_barcode: safeValue(salesOrder?.scan_barcode,"string"),
    set_warehouse: safeValue(salesOrder?.set_warehouse,"string"),
    reserve_stock: safeValue(salesOrder?.reserve_stock,"string"),

    // Discount and totals
    apply_discount_on: safeValue(salesOrder?.apply_discount_on,"string"),
    base_discount_amount: safeValue(salesOrder?.base_discount_amount,"number"),
    coupon_code: safeValue(salesOrder?.coupon_code,"string"),
    additional_discount_percentage: safeValue(salesOrder?.additional_discount_percentage,"number"),
    total_qty: safeValue(salesOrder?.total_qty,"number"),
    total: safeValue(salesOrder?.total,"number"),
    discount_amount: safeValue(salesOrder?.discount_amount,"number"),
    grand_total: safeValue(salesOrder?.grand_total,"number"),
    base_total: safeValue(salesOrder?.base_total,"number"),
    base_net_total: safeValue(salesOrder?.base_net_total,"number"),
    total_net_weight: safeValue(salesOrder?.total_net_weight,"number"),
    net_total: safeValue(salesOrder?.net_total,"number"),

    // Tax information
    tax_category: safeValue(salesOrder?.tax_category,"string"),
    taxes_and_charges: safeValue(salesOrder?.taxes_and_charges,"string"),
    shipping_rule: safeValue(salesOrder?.shipping_rule,"string"),
    incoterm: safeValue(salesOrder?.incoterm,"string"),
    named_place: safeValue(salesOrder?.named_place,"string"),
    base_total_taxes_and_charges: safeValue(salesOrder?.base_total_taxes_and_charges,"number"),
    total_taxes_and_charges: safeValue(salesOrder?.total_taxes_and_charges,"number"),
    base_grand_total: safeValue(salesOrder?.base_grand_total,"number"),
    base_rounding_adjustment: safeValue(salesOrder?.base_rounding_adjustment,"number"),
    base_rounded_total: safeValue(salesOrder?.base_rounded_total,"number"),
    base_in_words: safeValue(salesOrder?.base_in_words,"string"),
    rounding_adjustment: safeValue(salesOrder?.rounding_adjustment,"number"),
    rounded_total: safeValue(salesOrder?.rounded_total,"number"),
    in_words: safeValue(salesOrder?.in_words,"string"),
    advance_paid: safeValue(salesOrder?.advance_paid,"number"),
    disable_rounded_total: safeValue(salesOrder?.disable_rounded_total,"string"),
    other_charges_calculation: safeValue(salesOrder?.other_charges_calculation,"string"),

    // Contact and address information
    contact_person: safeValue(salesOrder?.contact_person,"string"),
    contact_display: safeValue(salesOrder?.contact_display,"string"),
    contact_phone: safeValue(salesOrder?.contact_phone,"string"),
    contact_mobile: safeValue(salesOrder?.contact_mobile,"string"),
    contact_email: safeValue(salesOrder?.contact_email,"string"),
    customer_address: safeValue(salesOrder?.customer_address,"string"),
    address_display: safeValue(salesOrder?.address_display,"string"),
    customer_group: safeValue(salesOrder?.customer_group,"string"),
    territory: safeValue(salesOrder?.territory,"string"),
    shipping_address_name: safeValue(salesOrder?.shipping_address_name,"string"),
    shipping_address: safeValue(salesOrder?.shipping_address,"string"),
    customer: safeValue(salesOrder?.customer,"string"),
    gender: safeValue(salesOrder?.gender,"string"),
    customer_type: safeValue(salesOrder?.customer_type,"string"),
    customer_personal_id: safeValue(salesOrder?.customer_personal_id,"string"),
    birth_date: safeValue(salesOrder?.birth_date,"date"),
    date_of_issuance: safeValue(salesOrder?.date_of_issuance,"date"),
    dispatch_address: safeValue(salesOrder?.dispatch_address,"string"),
    place_of_issuance: safeValue(salesOrder?.place_of_issuance,"string"),
    dispatch_address_name: safeValue(salesOrder?.dispatch_address_name,"string"),
    company_address: safeValue(salesOrder?.company_address,"string"),
    company_address_display: safeValue(salesOrder?.company_address_display,"string"),
    company_contact_person: safeValue(salesOrder?.company_contact_person,"string"),

    // Status information
    status: safeValue(salesOrder?.status,"string"),
    delivery_status: safeValue(salesOrder?.delivery_status,"string"),
    per_delivered: safeValue(salesOrder?.per_delivered,"number"),
    per_billed: safeValue(salesOrder?.per_billed,"number"),
    per_picked: safeValue(salesOrder?.per_picked,"number"),
    billing_status: safeValue(salesOrder?.billing_status,"string"),

    // Sales and commission
    sales_partner: safeValue(salesOrder?.sales_partner,"string"),
    amount_eligible_for_commission: safeValue(salesOrder?.amount_eligible_for_commission,"number"),
    commission_rate: safeValue(salesOrder?.commission_rate,"number"),
    total_commission: safeValue(salesOrder?.total_commission,"number"),
    loyalty_points: safeValue(salesOrder?.loyalty_points,"number"),
    loyalty_amount: safeValue(salesOrder?.loyalty_amount,"number"),
    from_date: safeValue(salesOrder?.from_date,"date"),
    to_date: safeValue(salesOrder?.to_date,"date"),
    auto_repeat: safeValue(salesOrder?.auto_repeat,"string"),
    primary_sales_person: safeValue(salesOrder?.primary_sales_person,"string"),

    // Print and display
    letter_head: safeValue(salesOrder?.letter_head,"string"),
    group_same_items: safeValue(salesOrder?.group_same_items,"string"),
    select_print_heading: safeValue(salesOrder?.select_print_heading,"string"),
    language: safeValue(salesOrder?.language,"string"),
    is_internal_customer: safeValue(salesOrder?.is_internal_customer,"string"),
    represents_company: safeValue(salesOrder?.represents_company,"string"),
    source: safeValue(salesOrder?.source,"string"),
    inter_company_order_reference: safeValue(salesOrder?.inter_company_order_reference,"string"),
    campaign: safeValue(salesOrder?.campaign,"string"),
    party_account_currency: safeValue(salesOrder?.party_account_currency,"string"),

    // Payment information
    total_amount: safeValue(salesOrder?.total_amount,"number"),
    expected_payment_date: safeValue(salesOrder?.expected_payment_date,"date"),
    paid_amount: safeValue(salesOrder?.paid_amount,"number"),
    balance: safeValue(salesOrder?.balance,"number"),
    payment_terms_template: safeValue(salesOrder?.payment_terms_template,"string"),
    tc_name: safeValue(salesOrder?.tc_name,"string"),
    terms: safeValue(salesOrder?.terms,"string"),

    // Haravan integration
    haravan_order_id: safeValue(salesOrder?.haravan_order_id,"string"),
    haravan_ref_order_id: safeValue(salesOrder?.haravan_ref_order_id,"string"),
    haravan_created_at: safeValue(salesOrder?.haravan_created_at,"date"),
    source_name: safeValue(salesOrder?.source_name,"string"),

    // JSONB fields - Prisma will handle JSON conversion automatically
    sales_team: salesOrder?.sales_team || null,
    ref_sales_orders: salesOrder?.ref_sales_orders || null,
    promotions: salesOrder?.promotions || null,
    product_categories: salesOrder?.product_categories || null,
    debt_history: salesOrder?.debt_history || null,
    packed_items: salesOrder?.packed_items || null,
    taxes: salesOrder?.taxes || null,
    pricing_rules: salesOrder?.pricing_rules || null,
    payment_records: salesOrder?.payment_records || null,
    payment_schedule: salesOrder?.payment_schedule || null,
    policies: salesOrder?.policies || null,
    items: salesOrder?.items || null,
    sales_order_purposes: salesOrder?.sales_order_purposes || null
  }));
};
